<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.0.0">
  <meta name="generator" content="Hugo 0.54.0" />

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Kleanthis Natsiopoulos">

  
  
  
    
  
  <meta name="description" content="Even the most *basic* statistical tests like ANOVA can lead to misleading results if we don&#39;t fully understand them. Example using samara, the maple tree fruit.">

  
  <link rel="alternate" hreflang="en-us" href="/post/anova-types/anova-types/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai-sublime.min.css" crossorigin="anonymous">
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono">
  

  <link rel="stylesheet" href="/styles.css">
  

  
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Kleanthis Natsiopoulos">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Kleanthis Natsiopoulos">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/anova-types/anova-types/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Kleanthis Natsiopoulos">
  <meta property="og:url" content="/post/anova-types/anova-types/">
  <meta property="og:title" content="Three types of ANOVA | Kleanthis Natsiopoulos">
  <meta property="og:description" content="Even the most *basic* statistical tests like ANOVA can lead to misleading results if we don&#39;t fully understand them. Example using samara, the maple tree fruit."><meta property="og:image" content="/post/anova-types/anova-types/featured.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-02-11T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2019-02-11T00:00:00&#43;00:00">
  

  

  

  <title>Three types of ANOVA | Kleanthis Natsiopoulos</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Kleanthis Natsiopoulos</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>About</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/publication/">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/post/">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  













<div class="article-header d-xl-none">
  <div class="featured-image" style="background-image: url('/post/anova-types/anova-types/featured_hu0454c163d662ca6f4956394a6014a795_78675_800x0_resize_q75_box.jpg');"></div>
  <span class="article-header-caption">Image credit: <a href="https://www.flickr.com/photos/gwendolyn_stansbury/13933085201/in/photostream/" target="_blank"><strong>flickr</strong></a></span>
</div>


<div class="container-fluid split-header d-none d-xl-block">
  <div class="row">
    <div class="col-6">
      <div class="split-header-content">
        <h1 itemprop="name">Three types of ANOVA</h1>

        
        <p class="page-subtitle">Understand ANOVA types and use them wisely</p>
        

        



<meta content="2019-02-11 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-02-11 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>11/02/2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/anova-types/anova-types/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/categories/do-it-right/">do it right</a>
    
  </span>
  
  

  

</div>


        







  










        
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Three%20types%20of%20ANOVA&amp;url=%2fpost%2fanova-types%2fanova-types%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fanova-types%2fanova-types%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fanova-types%2fanova-types%2f&amp;title=Three%20types%20of%20ANOVA"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fanova-types%2fanova-types%2f&amp;title=Three%20types%20of%20ANOVA"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Three%20types%20of%20ANOVA&amp;body=%2fpost%2fanova-types%2fanova-types%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
    </div>
    <div class="col-6">
      <div class="split-header-image">
        <img src="/post/anova-types/anova-types/featured_hu0454c163d662ca6f4956394a6014a795_78675_680x500_fill_q90_box_center.jpg" itemprop="image" alt="">
        <span class="article-header-caption">Image credit: <a href="https://www.flickr.com/photos/gwendolyn_stansbury/13933085201/in/photostream/" target="_blank"><strong>flickr</strong></a></span>
      </div>
    </div>
  </div>
</div>

<div class="article-container d-xl-none">
  <h1 itemprop="name">Three types of ANOVA</h1>

  
  <p class="page-subtitle">Understand ANOVA types and use them wisely</p>
  

  



<meta content="2019-02-11 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-02-11 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>11/02/2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/anova-types/anova-types/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/categories/do-it-right/">do it right</a>
    
  </span>
  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Three%20types%20of%20ANOVA&amp;url=%2fpost%2fanova-types%2fanova-types%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fanova-types%2fanova-types%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fanova-types%2fanova-types%2f&amp;title=Three%20types%20of%20ANOVA"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fanova-types%2fanova-types%2f&amp;title=Three%20types%20of%20ANOVA"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Three%20types%20of%20ANOVA&amp;body=%2fpost%2fanova-types%2fanova-types%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

  







  









</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<p>This is the first post of the series <a href="/categories/do-it-right/">do it right</a>. This series of posts is about usual misuses of methods that are supposed to be <em>basics</em> but many of us keep doing them in a wrong way.</p>
<p>ANOVA is taught in the university as one of our first steps in statistics after some basic probability theory, distributions and t-test. It is used as a means of measuring the differences among sample means and is practically an F-test. Here we will examine the use of ANOVA (F-test) in testing nested models, or in other words, in testing whether a factor in the regression is needed or not. This is a typical step when we try to build a model but although it is a trivial routine, how many of us really consider the three types of ANOVA and apply the correct one in each case? Or even, how many know about these three different types?</p>
<p>In this example I will use the <a href="http://www.statsci.org/data/general/samara.txt">samara dataset</a>. As Ryan et al (1994) describe:</p>
<blockquote>
<p>In autumn, small winged fruit called samara fall off maple trees, spinning as they go.</p>
</blockquote>
<p>Description of the problem:</p>
<blockquote>
<p>A forest scientist is interested in studying the relationship between the terminal velocity of falling maple samaras and a measure of their size and weight known as disk loading. A samara is the winged fruit that falls to the ground with a helicopter-like motion. The disk loading is a quantity related to helicopter aerodynamics. In an experiment samaras were randomly selected from each of three distinct trees (of the same species). The disk loading (loading) for each samara was determined and the terminal velocity (velocity) was measured in the laboratory. The forest scientist conducting the study hypothesizes that there is a linear relationship between terminal velocity and disk loading. <strong>The scientist wishes to determine whether the relationship is the same for each tree.</strong></p>
</blockquote>
<p>In other words, we want to determine whether the samara fruits fall with the same velocity from each tree, taking into account the size of the fruit in order for the comparison to be between fruits of the same size.</p>
<p>First, lets read the data and remove the observation which has NA. Then, we turn the variable <code>Tree</code> into a factor as we want it to represent the three trees and not some arbitrary numbers.</p>
<pre><code>library(ggplot2)
library(gridExtra)
library(car)</code></pre>
<pre class="r"><code>samara &lt;- read.table(&quot;http://www.statsci.org/data/general/samara.txt&quot;, header=TRUE)
samara &lt;- samara[complete.cases(samara), ]
samara$Tree &lt;- as.factor(samara$Tree)</code></pre>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Tree
</th>
<th style="text-align:right;">
Load
</th>
<th style="text-align:right;">
Velocity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.239
</td>
<td style="text-align:right;">
1.34
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.208
</td>
<td style="text-align:right;">
1.06
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.223
</td>
<td style="text-align:right;">
1.14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.224
</td>
<td style="text-align:right;">
1.13
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.246
</td>
<td style="text-align:right;">
1.35
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.213
</td>
<td style="text-align:right;">
1.23
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.198
</td>
<td style="text-align:right;">
1.23
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.219
</td>
<td style="text-align:right;">
1.15
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.241
</td>
<td style="text-align:right;">
1.25
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.210
</td>
<td style="text-align:right;">
1.24
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.224
</td>
<td style="text-align:right;">
1.34
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.269
</td>
<td style="text-align:right;">
1.35
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
1.20
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.206
</td>
<td style="text-align:right;">
1.06
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.172
</td>
<td style="text-align:right;">
0.88
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.235
</td>
<td style="text-align:right;">
1.24
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.247
</td>
<td style="text-align:right;">
1.37
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.239
</td>
<td style="text-align:right;">
1.37
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.233
</td>
<td style="text-align:right;">
1.43
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.234
</td>
<td style="text-align:right;">
1.32
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.189
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.192
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.209
</td>
<td style="text-align:right;">
1.12
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.192
</td>
<td style="text-align:right;">
0.91
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.200
</td>
<td style="text-align:right;">
1.13
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.175
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.187
</td>
<td style="text-align:right;">
0.98
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.181
</td>
<td style="text-align:right;">
0.96
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.195
</td>
<td style="text-align:right;">
0.88
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.155
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.179
</td>
<td style="text-align:right;">
0.91
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.184
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.177
</td>
<td style="text-align:right;">
0.87
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.177
</td>
<td style="text-align:right;">
1.02
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.186
</td>
<td style="text-align:right;">
0.94
</td>
</tr>
</tbody>
</table>
</div>
<p>From a simple box-plot we can see that the velocity is different between the trees. Particularly, tree 3 seems to have the lowest velocity, while trees 1 and 2 about the same. The box-plot and the scatter-plot also show that tree 2 has a wide range of velocities.</p>
<pre class="r"><code># Box-plot
box_plot &lt;- ggplot(samara, aes(x=Tree, y=Velocity, color=Tree)) +
    geom_boxplot()

# Scatter-plot clustered
scatter_plot_clustered &lt;- ggplot(samara, aes(x=Load, y=Velocity, shape=Tree, color=Tree)) +
  geom_point() + stat_ellipse()

# plot together
grid.arrange(box_plot, scatter_plot_clustered, nrow=2)</code></pre>
<p><img src="/post/anova-types/index_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Is this difference in velocity because of the size of the samara fruits or the tree also affects it? Would we expect a samara of specific load to fall with the same velocity from tree 1 as it would have fallen from tree 3? As a quick answer I would say, yes, there is no magic in the trees. But lets see what statistics have to say.</p>
<p>The first model considers only the factor <code>Tree</code>. The reference level is Tree1, and as we can see the coefficient of Tree3 is statistically significant which means that the mean velocity of Tree3 is significantly different from the mean velocity of Tree1 (the reference level) while Tree2 doesn’t differ. The ANOVA also indicates that total factor <code>Tree</code> is needed in the model as it appears to be statistically significant.</p>
<pre class="r"><code>model_tree &lt;- lm(Velocity~Tree, data=samara)
summary(model_tree)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Velocity ~ Tree, data = samara)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.300000 -0.082500  0.005833  0.087500  0.250000 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.23417    0.03676  33.571  &lt; 2e-16 ***
## Tree2       -0.05417    0.05316  -1.019    0.316    
## Tree3       -0.28333    0.05199  -5.450 5.37e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1274 on 32 degrees of freedom
## Multiple R-squared:  0.5097, Adjusted R-squared:  0.479 
## F-statistic: 16.63 on 2 and 32 DF,  p-value: 1.117e-05</code></pre>
<pre class="r"><code>anova(model_tree, test=&#39;F&#39;)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Velocity
##           Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
## Tree       2 0.53942 0.269708   16.63 1.117e-05 ***
## Residuals 32 0.51898 0.016218                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>But we have noticed that tree 3 has smaller fruits than the other two trees and thus with smaller load and this is probably what makes it to differe, not the tree itself.</p>
<p>To tests this hypothesis, lets build the full model. This model consists of the variables <code>Tree</code>, <code>Load</code> but also their interaction. ANOVA indicates that the interaction is statistically insignificant (at a=5%).</p>
<pre class="r"><code>full_model &lt;- lm(Velocity~Tree*Load, data=samara)
summary(full_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Velocity ~ Tree * Load, data = samara)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.120023 -0.049465 -0.001298  0.049938  0.145571 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   0.5414     0.2632   2.057   0.0488 *
## Tree2        -0.8408     0.3356  -2.505   0.0181 *
## Tree3        -0.2987     0.4454  -0.671   0.5078  
## Load          3.0629     1.1599   2.641   0.0132 *
## Tree2:Load    3.7343     1.5000   2.490   0.0188 *
## Tree3:Load    0.8205     2.2837   0.359   0.7220  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.07554 on 29 degrees of freedom
## Multiple R-squared:  0.8436, Adjusted R-squared:  0.8167 
## F-statistic: 31.29 on 5 and 29 DF,  p-value: 7.656e-11</code></pre>
<pre class="r"><code>anova(full_model, test=&#39;F&#39;)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Velocity
##           Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
## Tree       2 0.53942 0.269708  47.262 7.488e-10 ***
## Load       1 0.31554 0.315542  55.294 3.406e-08 ***
## Tree:Load  2 0.03795 0.018975   3.325   0.05011 .  
## Residuals 29 0.16549 0.005707                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In the next model we exclude the interaction as ANOVA suggested. We notice now that controlling for the Load, the Tree3 seems to have no significant difference from the Tree1 as it is statistically insignificant. On the other hand Load does matter. But remember that the regression output shows the difference between each level and the reference level (Tree1). To know if the total factor <code>Tree</code> is needed or not we take a look at the ANOVA table where it seems that the variables <code>Tree</code> and <code>Load</code> are both significant. This means that the size of the samara fruit matters but also the tree!</p>
<pre class="r"><code>model_tree_load &lt;- lm(Velocity~Tree + Load, data=samara)
summary(model_tree_load)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Velocity ~ Tree + Load, data = samara)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13572 -0.06027 -0.01576  0.05973  0.17130 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.07561    0.16871   0.448    0.657    
## Tree2       -0.01047    0.03440  -0.304    0.763    
## Tree3       -0.05879    0.04629  -1.270    0.213    
## Load         5.12257    0.73875   6.934 8.88e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08101 on 31 degrees of freedom
## Multiple R-squared:  0.8078, Adjusted R-squared:  0.7892 
## F-statistic: 43.43 on 3 and 31 DF,  p-value: 3.261e-11</code></pre>
<pre class="r"><code>anova(model_tree_load, test=&#39;F&#39;)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Velocity
##           Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
## Tree       2 0.53942 0.269708  41.098 1.913e-09 ***
## Load       1 0.31554 0.315542  48.082 8.884e-08 ***
## Residuals 31 0.20344 0.006563                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>So, why this inconsistency of the ANOVA results? The regression results suggest that neither Tree2 nor Tree3 differ from the reference level (Tree1) but ANOVA suggests that the total factor <code>Tree</code> which has three levels (Tree1, Tree2, Tree3) is useful in the model.</p>
<div id="the-three-types-of-anova" class="section level2">
<h2>The three types of ANOVA</h2>
<p><strong>Type I:</strong> SS(A), SS(B|A), SS(AB|A,B)</p>
<p>This is what R uses by default. This means that ANOVA performs the F-test in each term sequentially starting from the first. In our previous example of the model <code>model_tree_load</code> what is done is that ANOVA first performs the F-test in the variable <code>Tree</code> and it turns out to be significant for the same reasons why ANOVA for the <code>model_tree</code> indicates the variable <code>Tree</code> as significant. This is the phase SS(A), in our case SS(Tree).</p>
<p>After this, ANOVA tests the variable <code>Load</code> conditional on <code>Tree</code> (given <code>Tree</code>). This is the phase SS(B|A), in our case SS(Load|Tree).</p>
<p>What is happening here is that while the regression is simultaneously taking into account both Tree and Load, ANOVA doesn’t!</p>
<p>One solution could be to reverse the order of the variables in the regression. This way, the sequence in ANOVA is: SS(Load), SS(Tree|Load). As we can see, the total factor <code>Tree</code> accounting for the <code>Load</code> is now insignificant.</p>
<pre class="r"><code>model_tree_load2 &lt;- lm(Velocity~Load + Tree, data=samara)
anova(model_tree_load2, test=&#39;F&#39;)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: Velocity
##           Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## Load       1 0.84364 0.84364 128.5517 1.471e-12 ***
## Tree       2 0.01132 0.00566   0.8626    0.4319    
## Residuals 31 0.20344 0.00656                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Type II</strong>: SS(A|B), SS(B|A)</p>
<p>A more elegant way of doing this is to perform a type II ANOVA. This way each variable will be tested given the others. The function <code>Anova</code> from the package <code>car</code> can help us perform the type II ANOVA.</p>
<p>One can notice that the test results for the varaibles <code>Load</code> and <code>Tree</code> are now the same as those of the type I ANOVA on the models <code>model_tree_load</code> and <code>model_tree_load2</code> accordingly, where <code>Load</code> and <code>Tree</code> are the second variable in order in each case.</p>
<pre class="r"><code>Anova(model_tree_load, type=&quot;II&quot;, test.statistic=&#39;F&#39;)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: Velocity
##             Sum Sq Df F value    Pr(&gt;F)    
## Tree      0.011322  2  0.8626    0.4319    
## Load      0.315542  1 48.0817 8.884e-08 ***
## Residuals 0.203441 31                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Type III:</strong> SS(A|B,AB), SS(B|A,AB)</p>
<p>The type III ANOVA differs from the type II as it also accounts for the itneraction term. In our case there is no interaction so the results for <code>Tree</code> and <code>Load</code> would be the same.</p>
<pre class="r"><code>Anova(model_tree_load, type=&quot;III&quot;, test.statistic=&#39;F&#39;)</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: Velocity
##               Sum Sq Df F value    Pr(&gt;F)    
## (Intercept) 0.001318  1  0.2009    0.6571    
## Tree        0.011322  2  0.8626    0.4319    
## Load        0.315542  1 48.0817 8.884e-08 ***
## Residuals   0.203441 31                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>In conclusion, we found out that the Tree doesn’t affect the velocity, only the Load does. So for samara fruits of the same Load, the velocity would be the same for every tree. The reason why the velocity in the Tree 3 is smaller is because it has smaller fruits.</p>
<p>Is this so important after all? Are these just details? Or is it an essential knowledge about how ANOVA works?</p>
<p>In my opinion, the most important thing is to understand how something works. Then, it is not anymore a fuzzy type I, II, III, but a crystal clear situation where the order does matter.</p>
<p>The previous example could be a simple toy example for undergraduate students. But we saw how easy was to produce misleading results for someone who hasn’t heard of the above.</p>
<p>Understand it and just <a href="/categories/do-it-right/">do it right</a>!</p>
</div>
<div id="sources" class="section level2">
<h2>Sources</h2>
<p>Ryan, B.F., Joiner, B.L., and Rogosa, D. (1994). Minitab Handbook 3rd edition. Duxbury Press.</p>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/r/">R</a>
  
  <a class="badge badge-light" href="/tags/statistics/">statistics</a>
  
</div>




    
      






  







      
      
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "kleanthis-natsiopoulos" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<div class="container">
  <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    &copy; 2019 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    
    <script id="dsq-count-scr" src="//kleanthis-natsiopoulos.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.c1b0baf12cd491effaeeb294faf1e83e.js"></script>

  </body>
</html>

