[{"authors":["admin"],"categories":null,"content":" The URL of this page is going to change soon!\n  My name is Kleanthis Natsiopoulos. I live in Greece and my academic background is in Economics and Statistics, while I have worked as a Data Analyst in the oil and shipping industry. Currently, I am a Ph.D. Candidate in Economics at the University of Thessaly. My broad research interests include econometrics, machine learning, computational economics, statistics but most of all the combination of the above.\n","date":-62135596800,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":-62135596800,"objectID":"598b63dd58b43bce02403646f240cd3c","permalink":"/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"author","summary":"The URL of this page is going to change soon!\n  My name is Kleanthis Natsiopoulos. I live in Greece and my academic background is in Economics and Statistics, while I have worked as a Data Analyst in the oil and shipping industry. Currently, I am a Ph.D. Candidate in Economics at the University of Thessaly. My broad research interests include econometrics, machine learning, computational economics, statistics but most of all the combination of the above.","tags":null,"title":"Kleanthis Natsiopoulos","type":"author"},{"authors":null,"categories":null,"content":"This feature can be used for publishing content such as:\n Project or software documentation Online courses Tutorials  The parent folder may be renamed, for example, to docs for project documentation or course for creating an online course.\nTo disable this feature, either delete the parent folder, or set draft = true in the front matter of all its pages.\nAfter renaming or deleting the parent folder, you may wish to update any [[menu.main]] menu links to it in the config.toml.\n","date":1536440400,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1536440400,"objectID":"c3224f3a64174f08aaf31e1f1d16ffd3","permalink":"/tutorial/","publishdate":"2018-09-09T00:00:00+03:00","relpermalink":"/tutorial/","section":"tutorial","summary":"This feature can be used for publishing content such as:\n Project or software documentation Online courses Tutorials  The parent folder may be renamed, for example, to docs for project documentation or course for creating an online course.\nTo disable this feature, either delete the parent folder, or set draft = true in the front matter of all its pages.\nAfter renaming or deleting the parent folder, you may wish to update any [[menu.","tags":null,"title":"Overview","type":"docs"},{"authors":null,"categories":["do it right"],"content":"\r\rThis is the first post of the series do it right. This series of posts is about usual misuses of methods that are supposed to be basics but many of us keep doing them in a wrong way.\nANOVA is taught in the university as one of our first steps in statistics after some basic probability theory, distributions and t-test. It is used as a means of measuring the differences among sample means and is practically an F-test. Here we will examine the use of ANOVA (F-test) in testing nested models, or in other words, in testing whether a factor in the regression is needed or not. This is a typical step when we try to build a model but although it is a trivial routine, how many of us really consider the three types of ANOVA and apply the correct one in each case? Or even, how many know about these three different types?\nIn this example I will use the samara dataset. As Ryan et al (1994) describe:\n\rIn autumn, small winged fruit called samara fall off maple trees, spinning as they go.\n\rDescription of the problem:\n\rA forest scientist is interested in studying the relationship between the terminal velocity of falling maple samaras and a measure of their size and weight known as disk loading. A samara is the winged fruit that falls to the ground with a helicopter-like motion. The disk loading is a quantity related to helicopter aerodynamics. In an experiment samaras were randomly selected from each of three distinct trees (of the same species). The disk loading (loading) for each samara was determined and the terminal velocity (velocity) was measured in the laboratory. The forest scientist conducting the study hypothesizes that there is a linear relationship between terminal velocity and disk loading. The scientist wishes to determine whether the relationship is the same for each tree.\n\rIn other words, we want to determine whether the samara fruits fall with the same velocity from each tree, taking into account the size of the fruit in order for the comparison to be between fruits of the same size.\nFirst, lets read the data and remove the observation which has NA. Then, we turn the variable Tree into a factor as we want it to represent the three trees and not some arbitrary numbers.\nlibrary(ggplot2)\rlibrary(gridExtra)\rlibrary(car)\rsamara \u0026lt;- read.table(\u0026quot;http://www.statsci.org/data/general/samara.txt\u0026quot;, header=TRUE)\rsamara \u0026lt;- samara[complete.cases(samara), ]\rsamara$Tree \u0026lt;- as.factor(samara$Tree)\r\r\rTree\r\rLoad\r\rVelocity\r\r\r\r\r\r1\r\r0.239\r\r1.34\r\r\r\r1\r\r0.208\r\r1.06\r\r\r\r1\r\r0.223\r\r1.14\r\r\r\r1\r\r0.224\r\r1.13\r\r\r\r1\r\r0.246\r\r1.35\r\r\r\r1\r\r0.213\r\r1.23\r\r\r\r1\r\r0.198\r\r1.23\r\r\r\r1\r\r0.219\r\r1.15\r\r\r\r1\r\r0.241\r\r1.25\r\r\r\r1\r\r0.210\r\r1.24\r\r\r\r1\r\r0.224\r\r1.34\r\r\r\r1\r\r0.269\r\r1.35\r\r\r\r2\r\r0.238\r\r1.20\r\r\r\r2\r\r0.206\r\r1.06\r\r\r\r2\r\r0.172\r\r0.88\r\r\r\r2\r\r0.235\r\r1.24\r\r\r\r2\r\r0.247\r\r1.37\r\r\r\r2\r\r0.239\r\r1.37\r\r\r\r2\r\r0.233\r\r1.43\r\r\r\r2\r\r0.234\r\r1.32\r\r\r\r2\r\r0.189\r\r0.99\r\r\r\r2\r\r0.192\r\r1.00\r\r\r\r2\r\r0.209\r\r1.12\r\r\r\r2\r\rNA\r\rNA\r\r\r\r3\r\r0.192\r\r0.91\r\r\r\r3\r\r0.200\r\r1.13\r\r\r\r3\r\r0.175\r\r1.00\r\r\r\r3\r\r0.187\r\r0.98\r\r\r\r3\r\r0.181\r\r0.96\r\r\r\r3\r\r0.195\r\r0.88\r\r\r\r3\r\r0.155\r\r0.81\r\r\r\r3\r\r0.179\r\r0.91\r\r\r\r3\r\r0.184\r\r1.00\r\r\r\r3\r\r0.177\r\r0.87\r\r\r\r3\r\r0.177\r\r1.02\r\r\r\r3\r\r0.186\r\r0.94\r\r\r\r\r\rFrom a simple box-plot we can see that the velocity is different between the trees. Particularly, tree 3 seems to have the lowest velocity, while trees 1 and 2 about the same. The box-plot and the scatter-plot also show that tree 2 has a wide range of velocities.\n# Box-plot\rbox_plot \u0026lt;- ggplot(samara, aes(x=Tree, y=Velocity, color=Tree)) +\rgeom_boxplot()\r# Scatter-plot clustered\rscatter_plot_clustered \u0026lt;- ggplot(samara, aes(x=Load, y=Velocity, shape=Tree, color=Tree)) +\rgeom_point() + stat_ellipse()\r# plot together\rgrid.arrange(box_plot, scatter_plot_clustered, nrow=2)\rIs this difference in velocity because of the size of the samara fruits or the tree also affects it? Would we expect a samara of specific load to fall with the same velocity from tree 1 as it would have fallen from tree 3? As a quick answer I would say, yes, there is no magic in the trees. But lets see what statistics have to say.\nThe first model considers only the factor Tree. The reference level is Tree1, and as we can see the coefficient of Tree3 is statistically significant which means that the mean velocity of Tree3 is significantly different from the mean velocity of Tree1 (the reference level) while Tree2 doesn’t differ. The ANOVA also indicates that total factor Tree is needed in the model as it appears to be statistically significant.\nmodel_tree \u0026lt;- lm(Velocity~Tree, data=samara)\rsummary(model_tree)\r## ## Call:\r## lm(formula = Velocity ~ Tree, data = samara)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.300000 -0.082500 0.005833 0.087500 0.250000 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 1.23417 0.03676 33.571 \u0026lt; 2e-16 ***\r## Tree2 -0.05417 0.05316 -1.019 0.316 ## Tree3 -0.28333 0.05199 -5.450 5.37e-06 ***\r## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r## ## Residual standard error: 0.1274 on 32 degrees of freedom\r## Multiple R-squared: 0.5097, Adjusted R-squared: 0.479 ## F-statistic: 16.63 on 2 and 32 DF, p-value: 1.117e-05\ranova(model_tree, test=\u0026#39;F\u0026#39;)\r## Analysis of Variance Table\r## ## Response: Velocity\r## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## Tree 2 0.53942 0.269708 16.63 1.117e-05 ***\r## Residuals 32 0.51898 0.016218 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rBut we have noticed that tree 3 has smaller fruits than the other two trees and thus with smaller load and this is probably what makes it to differe, not the tree itself.\nTo tests this hypothesis, lets build the full model. This model consists of the variables Tree, Load but also their interaction. ANOVA indicates that the interaction is statistically insignificant (at a=5%).\nfull_model \u0026lt;- lm(Velocity~Tree*Load, data=samara)\rsummary(full_model)\r## ## Call:\r## lm(formula = Velocity ~ Tree * Load, data = samara)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.120023 -0.049465 -0.001298 0.049938 0.145571 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.5414 0.2632 2.057 0.0488 *\r## Tree2 -0.8408 0.3356 -2.505 0.0181 *\r## Tree3 -0.2987 0.4454 -0.671 0.5078 ## Load 3.0629 1.1599 2.641 0.0132 *\r## Tree2:Load 3.7343 1.5000 2.490 0.0188 *\r## Tree3:Load 0.8205 2.2837 0.359 0.7220 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r## ## Residual standard error: 0.07554 on 29 degrees of freedom\r## Multiple R-squared: 0.8436, Adjusted R-squared: 0.8167 ## F-statistic: 31.29 on 5 and 29 DF, p-value: 7.656e-11\ranova(full_model, test=\u0026#39;F\u0026#39;)\r## Analysis of Variance Table\r## ## Response: Velocity\r## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## Tree 2 0.53942 0.269708 47.262 7.488e-10 ***\r## Load 1 0.31554 0.315542 55.294 3.406e-08 ***\r## Tree:Load 2 0.03795 0.018975 3.325 0.05011 . ## Residuals 29 0.16549 0.005707 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rIn the next model we exclude the interaction as ANOVA suggested. We notice now that controlling for the Load, the Tree3 seems to have no significant difference from the Tree1 as it is statistically insignificant. On the other hand Load does matter. But remember that the regression output shows the difference between each level and the reference level (Tree1). To know if the total factor Tree is needed or not we take a look at the ANOVA table where it seems that the variables Tree and Load are both significant. This means that the size of the samara fruit matters but also the tree!\nmodel_tree_load \u0026lt;- lm(Velocity~Tree + Load, data=samara)\rsummary(model_tree_load)\r## ## Call:\r## lm(formula = Velocity ~ Tree + Load, data = samara)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.13572 -0.06027 -0.01576 0.05973 0.17130 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.07561 0.16871 0.448 0.657 ## Tree2 -0.01047 0.03440 -0.304 0.763 ## Tree3 -0.05879 0.04629 -1.270 0.213 ## Load 5.12257 0.73875 6.934 8.88e-08 ***\r## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r## ## Residual standard error: 0.08101 on 31 degrees of freedom\r## Multiple R-squared: 0.8078, Adjusted R-squared: 0.7892 ## F-statistic: 43.43 on 3 and 31 DF, p-value: 3.261e-11\ranova(model_tree_load, test=\u0026#39;F\u0026#39;)\r## Analysis of Variance Table\r## ## Response: Velocity\r## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## Tree 2 0.53942 0.269708 41.098 1.913e-09 ***\r## Load 1 0.31554 0.315542 48.082 8.884e-08 ***\r## Residuals 31 0.20344 0.006563 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rSo, why this inconsistency of the ANOVA results? The regression results suggest that neither Tree2 nor Tree3 differ from the reference level (Tree1) but ANOVA suggests that the total factor Tree which has three levels (Tree1, Tree2, Tree3) is useful in the model.\nThe three types of ANOVA\rType I: SS(A), SS(B|A), SS(AB|A,B)\nThis is what R uses by default. This means that ANOVA performs the F-test in each term sequentially starting from the first. In our previous example of the model model_tree_load what is done is that ANOVA first performs the F-test in the variable Tree and it turns out to be significant for the same reasons why ANOVA for the model_tree indicates the variable Tree as significant. This is the phase SS(A), in our case SS(Tree).\nAfter this, ANOVA tests the variable Load conditional on Tree (given Tree). This is the phase SS(B|A), in our case SS(Load|Tree).\nWhat is happening here is that while the regression is simultaneously taking into account both Tree and Load, ANOVA doesn’t!\nOne solution could be to reverse the order of the variables in the regression. This way, the sequence in ANOVA is: SS(Load), SS(Tree|Load). As we can see, the total factor Tree accounting for the Load is now insignificant.\nmodel_tree_load2 \u0026lt;- lm(Velocity~Load + Tree, data=samara)\ranova(model_tree_load2, test=\u0026#39;F\u0026#39;)\r## Analysis of Variance Table\r## ## Response: Velocity\r## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## Load 1 0.84364 0.84364 128.5517 1.471e-12 ***\r## Tree 2 0.01132 0.00566 0.8626 0.4319 ## Residuals 31 0.20344 0.00656 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rType II: SS(A|B), SS(B|A)\nA more elegant way of doing this is to perform a type II ANOVA. This way each variable will be tested given the others. The function Anova from the package car can help us perform the type II ANOVA.\nOne can notice that the test results for the varaibles Load and Tree are now the same as those of the type I ANOVA on the models model_tree_load and model_tree_load2 accordingly, where Load and Tree are the second variable in order in each case.\nAnova(model_tree_load, type=\u0026quot;II\u0026quot;, test.statistic=\u0026#39;F\u0026#39;)\r## Anova Table (Type II tests)\r## ## Response: Velocity\r## Sum Sq Df F value Pr(\u0026gt;F) ## Tree 0.011322 2 0.8626 0.4319 ## Load 0.315542 1 48.0817 8.884e-08 ***\r## Residuals 0.203441 31 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rType III: SS(A|B,AB), SS(B|A,AB)\nThe type III ANOVA differs from the type II as it also accounts for the itneraction term. In our case there is no interaction so the results for Tree and Load would be the same.\nAnova(model_tree_load, type=\u0026quot;III\u0026quot;, test.statistic=\u0026#39;F\u0026#39;)\r## Anova Table (Type III tests)\r## ## Response: Velocity\r## Sum Sq Df F value Pr(\u0026gt;F) ## (Intercept) 0.001318 1 0.2009 0.6571 ## Tree 0.011322 2 0.8626 0.4319 ## Load 0.315542 1 48.0817 8.884e-08 ***\r## Residuals 0.203441 31 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r\rConclusion\rIn conclusion, we found out that the Tree doesn’t affect the velocity, only the Load does. So for samara fruits of the same Load, the velocity would be the same for every tree. The reason why the velocity in the Tree 3 is smaller is because it has smaller fruits.\nIs this so important after all? Are these just details? Or is it an essential knowledge about how ANOVA works?\nIn my opinion, the most important thing is to understand how something works. Then, it is not anymore a fuzzy type I, II, III, but a crystal clear situation where the order does matter.\nThe previous example could be a simple toy example for undergraduate students. But we saw how easy was to produce misleading results for someone who hasn’t heard of the above.\nUnderstand it and just do it right!\n\rSources\rRyan, B.F., Joiner, B.L., and Rogosa, D. (1994). Minitab Handbook 3rd edition. Duxbury Press.\n\r","date":1549843200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549843200,"objectID":"c5f21e6cd103ad68a2d88b0b9f968031","permalink":"/post/anova-types/anova-types/","publishdate":"2019-02-11T00:00:00Z","relpermalink":"/post/anova-types/anova-types/","section":"post","summary":"Even the most *basic* statistical tests like ANOVA can lead to misleading results if we don't fully understand them. Example using samara, the maple tree fruit.","tags":["R","statistics"],"title":"Three types of ANOVA","type":"post"},{"authors":["Kleanthis Natsiopoulos","Alexandra Livada"],"categories":null,"content":"","date":1544911200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1544911200,"objectID":"f044afd6d6d76027fa149b2e5c9bc928","permalink":"/publication/tis-ardl-conference-poster/","publishdate":"2018-12-16T00:00:00+02:00","relpermalink":"/publication/tis-ardl-conference-poster/","section":"publication","summary":"The purpose is to explore the cointegrating relationships between the 1% top income share and the macroeconomic factors of credit, education, GDP, inflation, population growth and trade in order to reveal if there is a long-run relationship. This relationship is tested for four different countries: Greece, France, USA and UK. We are trying to see if the income inequality is driven by the same factors and in the same way for such different economies. The popular ARDL bounds test for cointegration is used for this analysis. There are strong indications supporting the existence of such a relationship for the cases of France and Greece. For the case of USA, the test suggests the existence of a long-run relationship but a simple graphical inspection is enough to tell us that this is a false positive alarm (type I error) as this is a degenerate relationship. Finally, for the case of UK a not well-defined model supports the longrun relationship hypothesis but a more carefully designed model is against this decision.","tags":["Econometrics","Time-Series","Cointegration"],"title":"An ARDL approach for income inequality: Case studies for France, Greece, UK and USA","type":"publication"},{"authors":null,"categories":null,"content":" Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = \\;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\nFragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \nA fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears  Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view   Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links   night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links  Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}  Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }  Questions? Ask\nDocumentation\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"c2915ec5da95791851caafdcba9664af","permalink":"/slides/example-slides/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/slides/example-slides/","section":"slides","summary":"Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$","tags":null,"title":"Slides","type":"slides"}]